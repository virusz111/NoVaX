<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoVaX RP | Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #a246f0; --bg: #030305; --card-bg: rgba(15, 15, 20, 0.95); --admin-red: #ff4d4d; --discord: #5865F2; --success: #2ecc71; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: white; margin: 0; overflow-x: hidden; }
        #video-background { position: fixed; inset: 0; z-index: -2; filter: brightness(0.3) blur(2px); object-fit: cover; width: 100%; height: 100%; }
        header { padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.9); border-bottom: 2px solid var(--primary); position: sticky; top: 0; z-index: 1000; }
        .nav-tabs { display: flex; justify-content: center; gap: 10px; background: rgba(0,0,0,0.8); padding: 10px; }
        .tab-btn { cursor: pointer; opacity: 0.6; font-weight: 700; transition: 0.3s; padding: 10px 20px; border-radius: 12px; color: white; border: 1px solid transparent; }
        .tab-btn.active { opacity: 1; color: var(--primary); background: rgba(162, 70, 240, 0.15); border: 1px solid var(--primary); }
        .container { max-width: 1100px; margin: 20px auto; padding: 20px; }
        .page-content { display: none; animation: fadeIn 0.5s ease forwards; }
        .page-content.active { display: block; }
        .card { background: var(--card-bg); padding: 30px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.05); text-align: center; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .btn { padding: 12px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; border: none; transition: 0.3s; font-family: 'Cairo'; color: white; width: 100%; margin-top: 10px; text-decoration: none; display: block; }
        .btn-primary { background: var(--primary); }
        .btn-admin { background: var(--admin-red); }
        .btn-success { background: var(--success); }
        input, textarea { width: 100%; padding: 15px; margin-top: 10px; background: rgba(255,255,255,0.05); border: 1px solid var(--primary); border-radius: 12px; color: white; box-sizing: border-box; outline: none; }
        .hidden { display: none !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<video autoplay muted loop id="video-background">
    <source src="https://assets.mixkit.co/videos/preview/mixkit-neon-lights-in-a-dark-hallway-4712-large.mp4" type="video/mp4">
</video>

<header>
    <div style="font-size: 28px; font-weight: 800; color: var(--primary);">NoVaX RP</div>
    <div id="auth-zone">
        <button id="loginBtn" class="btn btn-primary" style="width:auto; margin:0;" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</button>
        <div id="userProfile" class="hidden" style="display:flex; align-items:center; gap:12px;">
            <span id="displayUserName" style="font-weight:bold;"></span>
            <img id="userAvatar" src="" style="width:35px; border-radius:50%; border:2px solid var(--primary);">
            <button onclick="logout()" style="background:none; border:none; color:var(--admin-red); cursor:pointer; font-size:20px;"><i class="fas fa-sign-out-alt"></i></button>
        </div>
    </div>
</header>

<nav class="nav-tabs">
    <div class="tab-btn active" onclick="switchTab('home-page', this)">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
    <div class="tab-btn" onclick="switchTab('apply-page', this)">Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</div>
    <div id="adminTab" class="tab-btn hidden" onclick="switchTab('admin-page', this)" style="color:var(--admin-red);">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
</nav>

<main class="container">
    <section id="home-page" class="page-content active">
        <div class="card">
            <h1>NoVaX RP</h1>
            <p>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø£Ù‚ÙˆÙ‰ ØªØ¬Ø±Ø¨Ø© ÙˆØ§Ù‚Ø¹ÙŠØ©</p>
            <a href="https://discord.gg/HZFb5BZ8dZ" target="_blank" class="btn btn-primary" style="width:max-content; margin: 20px auto;">Ø³ÙŠØ±ÙØ± Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</a>
        </div>
    </section>

    <section id="apply-page" class="page-content">
        <div class="card">
            <div id="form-inner">
                <h2>ğŸ“ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ ØªÙØ¹ÙŠÙ„</h2>
                <input type="text" id="p_name" placeholder="Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¹Ù…Ø±">
                <textarea id="p_q" rows="4" placeholder="Ù„Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…ØŸ ÙˆÙ…Ø§ Ù‡Ùˆ Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ù€ RPØŸ"></textarea>
                <button class="btn btn-success" onclick="sendApply()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</button>
            </div>
            <div id="closed-inner" class="hidden">
                <h2 style="color:var(--admin-red);">âŒ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹</h2>
                <p>ØªØ§Ø¨Ø¹ Ù‚Ù†Ø§Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù„Ù…Ø¹Ø±ÙØ© Ù…ÙˆØ¹Ø¯ Ø§Ù„ÙØªØ­.</p>
            </div>
        </div>
    </section>

    <section id="admin-page" class="page-content">
        <div class="card">
            <h3>âš™ï¸ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… (Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯)</h3>
            <div style="display:flex; gap:10px;">
                <button class="btn btn-success" onclick="controlApply(true)">ÙØªØ­ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… âœ…</button>
                <button class="btn btn-admin" onclick="controlApply(false)">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… âŒ</button>
            </div>
            <p id="status-now" style="margin-top:20px; font-weight:bold; color:var(--primary);"></p>
        </div>
        <div class="card">
            <h3>ğŸ“¢ Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù† Ø³Ø±ÙŠØ¹</h3>
            <textarea id="annMsg" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†..."></textarea>
            <button class="btn btn-primary" onclick="announce()">Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† @everyone</button>
        </div>
    </section>
</main>

<script>
    const MY_ID = "1221794986203418704";
    const WEBHOOK_APPLY = "https://discord.com/api/webhooks/1466173783537750201/Dbm7MYHeWnFUHMhRoV0g-66Nfyni6kB3XXENjUL9aUEZWDGgjOjrGb0YtvOkOwOwwPaJ";
    const WEBHOOK_ANN = "https://discord.com/api/webhooks/1466228663962832959/HndTSLUdCtqJk7Sa8iRwDudzt-LmOi5i_x2MrL4yJ_2MTFjaPXM18XuM01z4sJp7MzsJ";

    // ÙˆØ¸ÙŠÙØ© Ø§Ù„ÙØªØ­ ÙˆØ§Ù„Ø¥ØºÙ„Ø§Ù‚ Ù…Ø¹ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
    window.controlApply = async function(isOpen) {
        localStorage.setItem('noVaX_applyStatus', isOpen ? 'open' : 'closed');
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
        const embed = {
            embeds: [{
                title: isOpen ? "âœ… ØªÙ… ÙØªØ­ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…" : "âŒ ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…",
                description: isOpen ? "@everyone Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ù…ÙØªÙˆØ­ Ø§Ù„Ø¢Ù† Ø¹Ø¨Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹!" : "@everyone ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø­Ø§Ù„ÙŠØ§Ù‹.",
                color: isOpen ? 0x2ecc71 : 0xff4d4d,
                timestamp: new Date()
            }]
        };

        try {
            await fetch(WEBHOOK_ANN, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(embed)
            });
            alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯!");
        } catch(e) { alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ø¨Ø·!"); }
        
        checkStatus();
    }

    function checkStatus() {
        const s = localStorage.getItem('noVaX_applyStatus') || 'open';
        document.getElementById('form-inner').classList.toggle('hidden', s !== 'open');
        document.getElementById('closed-inner').classList.toggle('hidden', s === 'open');
        const st = document.getElementById('status-now');
        if(st) st.innerText = "Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¢Ù†: " + (s === 'open' ? "Ù…ÙØªÙˆØ­ âœ…" : "Ù…ØºÙ„Ù‚ âŒ");
    }

    window.announce = async function() {
        const m = document.getElementById('annMsg').value;
        if(!m) return alert("Ø§ÙƒØªØ¨ Ø´ÙŠ!");
        await fetch(WEBHOOK_ANN, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: "@everyone\n" + m }) });
        alert("ØªÙ… Ø§Ù„Ù†Ø´Ø±!");
        document.getElementById('annMsg').value = "";
    }

    window.sendApply = async function() {
        if(!currentUser) return alert("Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!");
        const n = document.getElementById('p_name').value;
        const q = document.getElementById('p_q').value;
        if(!n || !q) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");
        await fetch(WEBHOOK_APPLY, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({
            embeds: [{ title: "ØªÙ‚Ø¯ÙŠÙ… Ø¬Ø¯ÙŠØ¯", color: 0xa246f0, fields: [{name:"Ø§Ù„Ø§Ø³Ù…", value:n}, {name:"Ø§Ù„ØªÙØ§ØµÙŠÙ„", value:q}, {name:"Ø§Ù„Ø­Ø³Ø§Ø¨", value:`<@${currentUser.id}>`}] }]
        }) });
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ!");
    }

    window.switchTab = function(id, btn) {
        document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        checkStatus();
    }

    const CLIENT_ID = "1444065204051906610";
    const REDIRECT_URI = window.location.origin + window.location.pathname;
    let currentUser = null;

    window.login = () => window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=identify`;
    window.logout = () => window.location.href = REDIRECT_URI;

    window.onload = () => {
        checkStatus();
        const params = new URLSearchParams(window.location.hash.substring(1));
        const token = params.get('access_token');
        if (token) {
            fetch('https://discord.com/api/users/@me', { headers: { authorization: `Bearer ${token}` } })
            .then(r => r.json()).then(user => {
                currentUser = user;
                document.getElementById('loginBtn').classList.add('hidden');
                document.getElementById('userProfile').classList.remove('hidden');
                document.getElementById('displayUserName').innerText = user.username;
                document.getElementById('userAvatar').src = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;
                if(user.id === MY_ID) document.getElementById('adminTab').classList.remove('hidden');
            });
        }
    };
</script>
</body>
</html>
